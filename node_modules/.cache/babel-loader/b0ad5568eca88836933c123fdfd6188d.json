{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ivang\\\\PycharmProjects\\\\Pirates\\\\src\\\\components\\\\authorization\\\\authorization.tsx\";\nimport React, { useContext, useEffect, useState } from 'react';\nimport AuthContext from '../../contexts/auth.context';\nimport styled from 'styled-components';\nimport Button from '../button/button';\nimport Input from '../input/input';\nimport Banner from '../banner/banner';\nimport md5 from 'md5';\nimport authBackground from '../../assets/auth.png';\nimport { passwordReg } from '../../constants/authorization.constants';\nimport socket from '../../helpers/socket';\nimport { SOCKET_EVENTS } from '../../constants/socket.constants';\nconst Container = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100vh;\n  background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(${authBackground}) no-repeat;\n  background-size: cover;\n`;\nconst Form = styled.form`\n  padding: 30px 10px;\n  display: flex;\n  flex-flow: column;\n`;\nconst ControlButtons = styled.div`\n  margin-top: 40px;\n  display: flex;\n  flex-flow: column;\n`;\n\nconst Authorization = () => {\n  const {\n    login\n  } = useContext(AuthContext);\n  const [form, setForm] = useState({\n    login: '',\n    password: ''\n  });\n  useEffect(() => {\n    socket.on(SOCKET_EVENTS.USER_LOGIN, ({\n      token\n    }) => login(token));\n    socket.on(SOCKET_EVENTS.USER_SIGNUP, ({\n      token\n    }) => login(token));\n  }, []);\n\n  const isValidPassword = () => {\n    return passwordReg.test(form.password);\n  };\n\n  const handleChange = ({\n    target\n  }) => {\n    setForm({ ...form,\n      [target.name]: target.value\n    });\n  };\n\n  const handleLogin = event => {\n    event.preventDefault();\n\n    if (isValidPassword()) {\n      const random = Math.random();\n      const hash = md5(md5(form.password + form.login) + random);\n      socket.emit(SOCKET_EVENTS.USER_LOGIN, {\n        login: form.login,\n        hash,\n        random\n      });\n    }\n  };\n\n  const handleSignup = event => {\n    event.preventDefault();\n    const {\n      login\n    } = form;\n\n    if (login && isValidPassword()) {\n      const hash = md5(form.password + login);\n      socket.emit(SOCKET_EVENTS.USER_SIGNUP, {\n        login,\n        hash\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Banner, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Input, {\n    id: \"login\",\n    type: \"text\",\n    placeholder: \"\\u041B\\u043E\\u0433\\u0438\\u043D\",\n    name: \"login\",\n    \"aria-label\": \"login\",\n    \"aria-describedby\": \"login\",\n    required: true,\n    autoComplete: \"username\",\n    autoFocus: true,\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Input, {\n    id: \"password\",\n    type: \"password\",\n    placeholder: \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",\n    name: \"password\",\n    \"aria-label\": \"password\",\n    \"aria-describedby\": \"password\",\n    required: true,\n    autoComplete: \"current-password\",\n    onChange: handleChange,\n    onFocus: event => event.target.select(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(ControlButtons, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    type: \"submit\",\n    onClick: handleLogin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 11\n    }\n  }, \"\\u0410\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F\"), /*#__PURE__*/React.createElement(Button, {\n    type: \"submit\",\n    onClick: handleSignup,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 11\n    }\n  }, \"\\u0417\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F\"))));\n};\n\nexport default Authorization;","map":{"version":3,"sources":["C:/Users/ivang/PycharmProjects/Pirates/src/components/authorization/authorization.tsx"],"names":["React","useContext","useEffect","useState","AuthContext","styled","Button","Input","Banner","md5","authBackground","passwordReg","socket","SOCKET_EVENTS","Container","div","Form","form","ControlButtons","Authorization","login","setForm","password","on","USER_LOGIN","token","USER_SIGNUP","isValidPassword","test","handleChange","target","name","value","handleLogin","event","preventDefault","random","Math","hash","emit","handleSignup","select"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport AuthContext from '../../contexts/auth.context';\nimport styled from 'styled-components';\nimport Button from '../button/button';\nimport Input from '../input/input';\nimport Banner from '../banner/banner';\nimport md5 from 'md5';\nimport authBackground from '../../assets/auth.png';\nimport { passwordReg } from '../../constants/authorization.constants';\nimport socket from '../../helpers/socket';\nimport { SOCKET_EVENTS } from '../../constants/socket.constants';\n\nconst Container = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100vh;\n  background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(${authBackground}) no-repeat;\n  background-size: cover;\n`;\n\nconst Form = styled.form`\n  padding: 30px 10px;\n  display: flex;\n  flex-flow: column;\n`;\n\nconst ControlButtons = styled.div`\n  margin-top: 40px;\n  display: flex;\n  flex-flow: column;\n`;\n\nconst Authorization = () => {\n  const { login } = useContext(AuthContext);\n  const [form, setForm] = useState({ login: '', password: '' });\n\n  useEffect(() => {\n    socket.on(SOCKET_EVENTS.USER_LOGIN, ({ token }) => login(token))\n    socket.on(SOCKET_EVENTS.USER_SIGNUP, ({ token }) => login(token))\n  }, []);\n\n  const isValidPassword = () => {\n    return passwordReg.test(\n      form.password,\n    );\n  };\n\n  const handleChange = ({ target }) => {\n    setForm({\n      ...form,\n      [target.name]: target.value,\n    });\n  };\n\n  const handleLogin = (event) => {\n    event.preventDefault();\n    if (isValidPassword()) {\n      const random = Math.random();\n      const hash = md5(md5(form.password + form.login) + random);\n      \n      socket.emit(SOCKET_EVENTS.USER_LOGIN, { login: form.login, hash, random });\n      \n    }\n  };\n\n  const handleSignup = (event) => {\n    event.preventDefault();\n    const { login } = form;\n    if (login && isValidPassword()) {\n      const hash = md5(form.password + login);\n      \n      socket.emit(SOCKET_EVENTS.USER_SIGNUP, { login, hash })\n    }\n  };\n\n  return (\n    <Container>\n      <Form>\n        <Banner />\n        <Input\n          id=\"login\"\n          type=\"text\"\n          placeholder=\"Логин\"\n          name=\"login\"\n          aria-label=\"login\"\n          aria-describedby=\"login\"\n          required\n          autoComplete=\"username\"\n          autoFocus\n          onChange={handleChange}\n        />\n        <Input\n          id=\"password\"\n          type=\"password\"\n          placeholder=\"Пароль\"\n          name=\"password\"\n          aria-label=\"password\"\n          aria-describedby=\"password\"\n          required\n          autoComplete=\"current-password\"\n          onChange={handleChange}\n          onFocus={(event) => event.target.select()}\n        />\n        <ControlButtons>\n          <Button type=\"submit\" onClick={handleLogin}>Авторизоваться</Button>\n          <Button type=\"submit\" onClick={handleSignup}>Зарегистрироваться</Button>\n        </ControlButtons>\n      </Form>\n    </Container>\n  );\n};\n\nexport default Authorization;\n"]},"metadata":{},"sourceType":"module"}